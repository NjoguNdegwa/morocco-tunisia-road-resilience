import geopandas as gpd

def compute_exposed_roads(roads_path, flood_zone_path):
    roads = gpd.read_file(roads_path)
    flood = gpd.read_file(flood_zone_path)
    exposed = gpd.overlay(roads, flood, how='intersection')
    exposed['length_m'] = exposed.geometry.length
    return exposed

if __name__ == "__main__":
    exposed_ma = compute_exposed_roads(
        'data/morocco/roads_clipped.gpkg',
        'data/climate/sea_level_morocco.gpkg'
    )
    exposed_ma.to_file('results/morocco_exposed.gpkg', driver='GPKG')

    exposed_tn = compute_exposed_roads(
        'data/tunisia/roads_clipped.gpkg',
        'data/climate/sea_level_tunisia.gpkg'
    )
    exposed_tn.to_file('results/tunisia_exposed.gpkg', driver='GPKG')
